<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libelec: nettest Utility</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libelec
   </div>
   <div id="projectbrief">A general purpose library of utility functions designed to make it easier to develop addons for the X-Plane flight simulator.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">nettest Utility </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This utility lets you load and try out your electrical networks outside of a simulator, allowing you to quickly iterate on the network configuration file. It also serves as a demonstration on how to use libelec from code.</p>
<h1><a class="anchor" id="autotoc_md56"></a>
Building</h1>
<p>The <code>nettest</code> utility uses CMake for driving the build. Currently, the utility depends on having POSIX <code>getopt()</code> available. As such, it may not build on Windows outside of a suitable POSIX environment (such as WSL).</p>
<p>To build <code>nettest</code>, issue the following commands on the command line:</p>
<div class="fragment"><div class="line">$ mkdir libelec/nettest/build</div>
<div class="line">$ cd libelec/nettest/build</div>
<div class="line">$ cmake ..</div>
<div class="line">$ cmake --build .</div>
</div><!-- fragment --><p>This will build a binary called <code>nettest</code> (or <code>nettest.exe</code> on Windows) in the <code>build</code> directory.</p>
<h2><a class="anchor" id="autotoc_md57"></a>
GNU Readline Support</h2>
<p><code>nettest</code> can utilize the GNU readline library to provide sophisticated command line editing and tab completion features. The <code>CMakeLists.txt</code> file provided with <code>nettest</code> auto-detects the presence of GNU readline and enables support for it if present. You simply need to make sure you have the GNU readline library as well as development headers for it installed.</p>
<h1><a class="anchor" id="autotoc_md58"></a>
Running</h1>
<p>To run the utility, pass a path to the electrical network definition file as the last argument. A sample network definition is provided in the <code>nettest</code> directory named <code>test.net</code>:</p>
<div class="fragment"><div class="line">$ ./nettest ../test.net</div>
<div class="line">&gt;</div>
</div><!-- fragment --><p>When the <code>&gt;</code> prompt appears, nettest has finished loading your network definition file, has started the network and is ready to accept interactive commands to manipulate the network. Example of running an interactive command:</p>
<div class="fragment"><div class="line">&gt; gen</div>
<div class="line">GEN NAME                           RPM    W_in     Eff   U_out   I_out   W_out</div>
<div class="line">------------------------------  ------  ------  ------  ------  ------  ------</div>
<div class="line">GEN_1                              0.0      0W   90.0%  0.000V  0.000A      0W</div>
<div class="line">GEN_2                              0.0      0W   90.0%  0.000V  0.000A      0W</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md59"></a>
Init commands</h1>
<p>If you want to repeatedly load and configure a network for testing/development purposes, you may want to save your initialization commands to configure the network into a suitable state into a separate file. You can then pass the file to <code>nettest</code>, to be invoked prior to the network being started:</p>
<div class="fragment"><div class="line">$ ./nettest -i ../init_cmds.txt ../test.net</div>
</div><!-- fragment --><p>The commands are executed as if you had typed them on the interactive prompt. Afterwards, you can continue entering interactive commands to manipulate the network as usual.</p>
<h1><a class="anchor" id="autotoc_md60"></a>
Interactive Commands</h1>
<p>Commands use the following general syntax:</p>
<div class="fragment"><div class="line">COMMAND [optional_argument(s)...]</div>
<div class="line">COMMAND &lt;mandatory_argument&gt; SUBCOMMAND [optional_argument(s)...]</div>
</div><!-- fragment --><p>If an argument uses angle brackets (<code>&lt;something&gt;</code>), you MUST provide a value for the argument. If the argument uses square brackets instead (<code>[something]</code>), the argument is optional and may be omitted.</p>
<p>Most commands have a plain version without any arguments. Those commands will print out the state of all the instances of a given component type in tabular form.</p>
<h2><a class="anchor" id="autotoc_md61"></a>
Buses</h2>
<div class="fragment"><div class="line">bus [BUS_NAME]</div>
</div><!-- fragment --><p> Print all buses with voltages, currents and power flows. Use this to get a quick overview of the network state. If you provide an optional bus name, only the data for the listed bus will be printed. Table columns:</p>
<ul>
<li><code>U</code> - voltage on the bus</li>
</ul>
<div class="fragment"><div class="line">bus &lt;BUS_NAME&gt; list [DEVICE ...]</div>
</div><!-- fragment --><p> Lists the state of all devices attached to the specified bus. You may provide an optional list of devices to narrow the printout to only those devices listed.</p>
<h2><a class="anchor" id="autotoc_md62"></a>
Generators</h2>
<div class="fragment"><div class="line">gen [GEN_NAME]</div>
</div><!-- fragment --><p>Prints all generators on the network. If you provide an optional generator name, only the data for the listed generator will be printed. Table columns:</p>
<ul>
<li><code>RPM</code> - the RPM value at which the generator is currently operating</li>
<li><code>W_in</code> - input power demand from the generator on its mechanical input.</li>
<li><code>Eff</code> - current generator efficiency in percent.</li>
<li><code>U_out</code> - current generator output voltage.</li>
<li><code>I_out</code> - current generator output current.</li>
<li><code>W_out</code> - current generator output power load.</li>
</ul>
<div class="fragment"><div class="line">gen &lt;GEN_NAME&gt; rpm &lt;RPM&gt;</div>
</div><!-- fragment --><p> Sets a new generator rpm value in the same units as what was used in the electrical network definition.</p>
<h2><a class="anchor" id="autotoc_md63"></a>
TRUs and Inverters</h2>
<div class="fragment"><div class="line">tru [TRU_NAME|INV_NAME]</div>
</div><!-- fragment --><p> Prints all TRUs and inverters on the network. If you provide an optional TRU/inverter name, only the data for the listed TRU/inverter will be printed. Table columns:</p>
<ul>
<li><code>U_in</code> - input voltage into the TRU/inverter in Volts</li>
<li><code>W_in</code> - input power draw into the TRU/inverter in Watts</li>
<li><code>Eff</code> - TRU/inverter power conversion efficiency in percent</li>
<li><code>U_out</code> - output voltage out of the TRU/inverter in Volts</li>
<li><code>I_out</code> - output current out of the TRU/inverter in Amps</li>
<li><code>W_out</code> - output power out of the TRU/inverter in Watts</li>
</ul>
<h2><a class="anchor" id="autotoc_md64"></a>
Loads</h2>
<div class="fragment"><div class="line">load [LOAD_NAME]</div>
</div><!-- fragment --><p>Print all loads. If you provide an optional load name, only the data for the listed load will be printed. Table columns:</p>
<ul>
<li><code>U_out</code> - output voltage out of the load's power supply</li>
<li><code>I_out</code> - output current out of the load's power supply</li>
<li><code>W_out</code> - output power out of the load's power supply</li>
<li><code>U_c_in</code> - voltage of the power supply's virtual input capacitance</li>
<li><code>I_in</code> - input current into the load's power supply</li>
</ul>
<div class="fragment"><div class="line">load &lt;LOAD_NAME&gt; set &lt;AMPS|WATTS&gt;</div>
</div><!-- fragment --><p>Configures a constant load for an ELEC_LOAD device. Whether the load expects a specification in Amps or Watts depends on whether the device is declared as having a stabilized input power supply or not in the network definition (STAB line). N.B. the load argument must NOT be negative.</p>
<h2><a class="anchor" id="autotoc_md65"></a>
Circuit Breakers</h2>
<div class="fragment"><div class="line">cb [CB_NAME]</div>
</div><!-- fragment --><p>Prints the state of all circuit breakers. If you provide an optional breaker name, only the data for the listed breaker will be printed.</p>
<div class="fragment"><div class="line">cb &lt;CB_NAME&gt; set &lt;Y|N|1|0&gt;</div>
</div><!-- fragment --><p>Sets/resets a circuit breaker. A breaker that's set ('1' or 'Y') allows current flow, while a reset breaker ('0' or 'N') does not.</p>
<h2><a class="anchor" id="autotoc_md66"></a>
Ties</h2>
<div class="fragment"><div class="line">tie [TIE_NAME]</div>
</div><!-- fragment --><p>Prints a list of all ties and their state. The table lists each tie, and a list of buses currently tied into it. If you provide an optional tie name, only the data for the listed tie will be printed.</p>
<div class="fragment"><div class="line">tie &lt;TIE_NAME&gt; &lt;all|none|BUS1 BUS2 ...&gt;</div>
</div><!-- fragment --><p>Configures a tie. The remaining arguments must be a list of buses to which the tie connects. Any buses not mentioned will become untied. You can also use the symbolic keywords "none" and "all" to untie and tie all buses connected to the tie, respectively.</p>
<h2><a class="anchor" id="autotoc_md67"></a>
Batteries</h2>
<div class="fragment"><div class="line">batt [BATT_NAME]</div>
</div><!-- fragment --><p>Print the state of all batteries. If you provide an optional battery name, only the data for the listed battery will be printed. Table columns:</p>
<ul>
<li><code>U_out</code> - output voltage</li>
<li><code>I_out</code> - discharge current</li>
<li><code>I_in</code> - recharge current</li>
<li><code>CHG</code> - relative state of charge</li>
<li><code>TEMP</code> - temperature</li>
</ul>
<div class="fragment"><div class="line">batt &lt;BATT_NAME&gt; chg &lt;0..100&gt;</div>
</div><!-- fragment --><p>Sets a new relative charge state of the battery in percent.</p>
<div class="fragment"><div class="line">batt &lt;BATT_NAME&gt; temp &lt;TEMP°C&gt;</div>
</div><!-- fragment --><p>Sets a new battery temperature in degrees Celsius.</p>
<h2><a class="anchor" id="autotoc_md68"></a>
Image Drawing</h2>
<div class="fragment"><div class="line">draw [filename.png] [COMP_NAME]</div>
</div><!-- fragment --><p>Draw a rendered image of the network. Your network must use <code>GUI_*</code> stanzas in its network definition to control how the render is to be done. This is useful for quickly iterating on the network render, instead of having to wait for an aircraft reload in the simulator. The rendering offset, scale factor, font size and image size can be changed using the subcommands below.</p>
<dl class="section note"><dt>Note</dt><dd>the filename argument is optional only after the first successful invocation of this command. This defines which file nettest is supposed to write into. Subsequent invocations of the "draw" command without arguments simply overwrite this file with a new image when it becomes available.</dd></dl>
<p>If you specify a component following the filename, that component is drawn with its details box overlaid on top of it, as if the user had clicked on it in the interactive network visualizer.</p>
<div class="fragment"><div class="line">draw offset &lt;pixels_x&gt; &lt;pixels_y&gt;</div>
</div><!-- fragment --><p>Sets the network drawing offset in pixels. The default offset is zero for both X and Y.</p>
<div class="fragment"><div class="line">draw scale &lt;scale&gt;</div>
</div><!-- fragment --><p>Sets the rendering scale for network drawing. The default rendering scale is 16.</p>
<div class="fragment"><div class="line">draw fontsz &lt;size&gt;</div>
</div><!-- fragment --><p>Sets the font size for network drawing. The default font size is 14 points.</p>
<div class="fragment"><div class="line">draw imgsz &lt;pixels_x&gt; &lt;pixels_y&gt;</div>
</div><!-- fragment --><p>Sets the image size for network drawing. The default image size is 2048 x 2048. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
