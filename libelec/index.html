<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libelec: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libelec
   </div>
   <div id="projectbrief">A general purpose library of utility functions designed to make it easier to develop addons for the X-Plane flight simulator.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">libelec Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md0"></a>
Introduction</h1>
<p>This is an aircraft electrical system simulation library for use in flight simulators such as X-Plane and MSFS. It can also be used outside of any particular flight simulator.</p>
<h2><a class="anchor" id="autotoc_md1"></a>
Donations</h2>
<p>If you like my work, consider leaving a donation by following the PayPal link below:</p>
<p><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=8DN9LYD5VP4NY"><img src="https://img.shields.io/badge/Donate-PayPal-green.svg" alt="Donate" style="pointer-events: none;" class="inline"/></a></p>
<h2><a class="anchor" id="autotoc_md2"></a>
License</h2>
<p>This library is licensed under the Mozilla Public License v2.0. This lets you incorporate it into your projects (even closed-source/payware ones), <b>without having to disclose your proprietary source code</b>. The license only requires that you disclose modifications which you have made to the source code contained in this library. Any files that are not part of this library are <b>not</b> covered by this requirement.</p>
<p>For the full text of the license, see <a class="el" href="md__home_diablos__next_dev__c_l650_plugins_systems_src_libelec__c_o_p_y_i_n_g.html">COPYING</a>.</p>
<dl class="section see"><dt>See also</dt><dd>For a quick summary of things you must do to comply with libelec's license when used in your project, see Q8 through Q10 here: <a href="https://www.mozilla.org/en-US/MPL/2.0/FAQ/">MPL v2.0 Frequently Asked Questions</a></dd></dl>
<h2><a class="anchor" id="autotoc_md3"></a>
Documentation</h2>
<p>To access the full documentation set for libelec, go to: <a href="https://skiselkov.github.io/libelec">https://skiselkov.github.io/libelec</a></p>
<h2><a class="anchor" id="autotoc_md4"></a>
History</h2>
<p>libelec was developed for the <a href="https://www.x-aviation.com/catalog/product_info.php/take-command-hot-start-challenger-650-p-212">Hot Start CL650</a> for X-Plane, whiich uses libelec to implement its entire electrical system. This includes:</p>
<ul>
<li>~450 electrical buses</li>
<li>&gt;800 devices connected to those buses</li>
<li>~400 circuit breakers</li>
</ul>
<p>libelec gives you the power to do that same level of sophistication in your project without having to rewrite thousands of lines of multi-threaded spaghetti code. Enjoy!</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Prerequisites</h2>
<p>libelec depends on libacfutils, which you can get here: <a href="https://github.com/skiselkov/libacfutils">https://github.com/skiselkov/libacfutils</a></p>
<p>You will also require a C99-compliant compiler. Most modern C compilers should be able to compile libelec, including GCC (v3.1+), Clang (v1.0+) and MSVC (Visual Studio 2015+).</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Building</h2>
<p>You can build libelec in one of two ways:</p>
<ol type="1">
<li><p class="startli"><b>The preferred method:</b> simply include the source files of the library in your project. The library's core functionality is implemented in <code><a class="el" href="libelec_8c_source.html">libelec.c</a></code>, so that's the only file you need to add. See "Directly Incorporating Into Your Project" below for more information on some build-control macros you can define to fine-tune the build.</p>
<p class="startli">If you wish to include the state visualization capability, you will need to also add <code><a class="el" href="libelec__drawing_8c_source.html">libelec_drawing.c</a></code> and <code><a class="el" href="libelec__vis_8c_source.html">libelec_vis.c</a></code> to your build as well. See <code><a class="el" href="libelec__drawing_8h.html">libelec_drawing.h</a></code> and <code><a class="el" href="libelec__vis_8h.html">libelec_vis.h</a></code> for more information.</p>
<dl class="section note"><dt>Note</dt><dd>The built-in visualization capability currently depends on X-Plane's SDK. If you want to use it from another simulator, you might need to do some porting work. As always, pull requests are welcome.</dd></dl>
</li>
<li>Use CMake and the included <code>src/CMakeLists.txt</code> file to build a static library. You will then want to add this library to your linker inputs. See "Building Using CMake" below for more details.</li>
</ol>
<p>In both cases, you will need to include <code><a class="el" href="libelec_8h.html">libelec.h</a></code> from your project to control the library.</p>
<h3><a class="anchor" id="autotoc_md7"></a>
Directly Incorporating Into Your Project</h3>
<p>libelec is written in C99, so you will want to make sure your compiler's C language mode is set to at least C99 (newer is ok, but ANSI C90, ISO C89 or K&amp;R C are too old). You can also define the following optional compiler macros to fine-tune the libelec build:</p>
<ul>
<li><code>XPLANE</code> - if this macro is defined, libelec will depend on running inside of X-Plane and having the XPLM available. The benefit is that libelec will be able to automatically adapt its simulation rate to that of X-Plane. If the user enters time acceleration, libelec will automatically "follow" along. If you want to utilize libelec in a different (non-XPlane) environment, you will need to control the simulation rate yourself by calling <a class="el" href="libelec_8h.html#a1dd482ab4f0bc8b029a4bd871f11f48d">libelec_sys_set_time_factor()</a> regularly.</li>
<li><code>LIBELEC_WITH_DRS</code> - if defined, libelec will expose all component state via X-Plane read-only datarefs. Every component will have a set aof double-precision floating point datarefs constructed for it, using the following pattern:<ul>
<li><code>libelec/comp/&lt;COMPONENT_NAME&gt;/in_volts</code></li>
<li><code>libelec/comp/&lt;COMPONENT_NAME&gt;/out_volts</code></li>
<li><code>libelec/comp/&lt;COMPONENT_NAME&gt;/in_amps</code></li>
<li><code>libelec/comp/&lt;COMPONENT_NAME&gt;/out_amps</code></li>
<li><code>libelec/comp/&lt;COMPONENT_NAME&gt;/in_pwr</code></li>
<li><code>libelec/comp/&lt;COMPONENT_NAME&gt;/out_pwr</code></li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md8"></a>
Building Using CMake</h3>
<p>Building the project using CMake will produce a static library, which you can then link into your project. To build using the included <code>CMakeLists.txt</code> file, do the following:</p>
<ol type="1">
<li>Create a <code>build</code> subdirectory under <code>src</code> to hold the build products: <div class="fragment"><div class="line">$ mkdir src/build</div>
<div class="line">$ cd src/build</div>
</div><!-- fragment --></li>
<li>Configure CMake. Please note that you will require the redistributable package of libacfutils installed somewhere (say at path <code>${LIBACFUTILS}</code>): <div class="fragment"><div class="line">$ cmake -DLIBACFUTILS=${LIBACFUTILS} ..</div>
</div><!-- fragment --></li>
<li>Now just run the build: <div class="fragment"><div class="line">$ cmake --build .</div>
</div><!-- fragment --></li>
</ol>
<p>This will produce a static library named either <code>libelec.lib</code> (on Windows), or <code>libelec.a</code> (on macOS and Linux). On macOS, the built library will contain both the x86-64 and arm64 bits and can thus be used to build universal software. On Linux, you can cross-compile to Windows (MinGW) using the following CMake command instead (you will obviously also need to have the MinGW toolchain installed separately):</p>
<div class="fragment"><div class="line">$ cmake .. -DLIBACFUTILS=${LIBACFUTILS} \</div>
<div class="line">    -DCMAKE_TOOLCHAIN_FILE=../XCompile.cmake -DHOST=x86_64-w64-mingw32</div>
<div class="line">$ make</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md9"></a>
Usage</h2>
<p>To initialize the library, use <a class="el" href="libelec_8h.html#a726d387a49134ed486ff6c85967beb79">libelec_new()</a>. This loads an electrical network definition file and returns a network handle. This network can then be started using <a class="el" href="libelec_8h.html#ae89af50399d40bf3d501c44d6200d9aa">libelec_sys_start()</a>. Once started, you can then control the network component state using the various component functions contained in <code><a class="el" href="libelec_8h.html">libelec.h</a></code> while the network operates asynchronously on a background thread.</p>
<p>Before shutting down, you must first stop the network using <a class="el" href="libelec_8h.html#a494c5d3d0246792f8fb1497572d646d2">libelec_sys_stop()</a> and subsequently deallocate the network using <a class="el" href="libelec_8h.html#ae11d4ec058cda24f00c6b8470227a452">libelec_destroy()</a>.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
Thread-Safety</h2>
<p>Unless stated otherwise, all libelec functions are thread safe.</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Configuration File Format</h2>
<p>libelec requires that you specify a configuration file every time you call <a class="el" href="libelec_8h.html#a726d387a49134ed486ff6c85967beb79">libelec_new()</a>. This file defines the entire electrical network which is to be simulated.</p>
<p>See <a class="el" href="md__home_diablos__next_dev__c_l650_plugins_systems_src_libelec__conf_file_format.html">Configuration File Format</a> for more information on how the configuration file must be constructed. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
