<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libelec: Configuration File Format</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libelec
   </div>
   <div id="projectbrief">A general purpose library of utility functions designed to make it easier to develop addons for the X-Plane flight simulator.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Configuration File Format </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>When initializing libelec using <a class="el" href="libelec_8h.html#a726d387a49134ed486ff6c85967beb79">libelec_new()</a>, you must supply a specially formatted configuration file, which defines the network components, their properties and how all components are interconnected. You can place comments into the file by prefixing them with the <code>#</code> character.</p>
<h1><a class="anchor" id="autotoc_md14"></a>
Limitations On Network Layout</h1>
<p>While libelec can simulate a wide variety of electrical networks, it is not intended to be a highly accurate general-purpose electronics simulation system. Its primary purpose is to account for overall energy flows within an electrical system, which devices are powered and through which connections energy is flowing.</p>
<p>With the design goals in mind, let's review the general design properties that your electrical network must follow:</p>
<ol type="1">
<li>The network is composed of two classes of components: devices and buses.<ul>
<li>Devices are components which provide some useful function, such as being sources of electrical energy (batteries, generators) or consumers (loads).</li>
<li>Buses are the connective tissue of the network. They serve as conduits for electrical energy between energy sources and consumers.</li>
</ul>
</li>
<li>Devices may only connect to buses, and buses may only connect to devices. Thus to create a chain of components, you will need to place intermediate buses in between, like so: <div class="fragment"><div class="line">                  Valid network structure:</div>
<div class="line"> </div>
<div class="line">                         ┌────────┐</div>
<div class="line">                 ┌───────┤ Device ├───────┐</div>
<div class="line">                 │       └────────┘       │</div>
<div class="line">                 │                        │</div>
<div class="line">              ┌──┴──┐                  ┌──┴──┐</div>
<div class="line">┌────────┐    │     │    ┌────────┐    │     │    ┌────────┐</div>
<div class="line">│ Device ├────┤ Bus ├────┤ Device ├────┤ Bus ├────┤ Device │</div>
<div class="line">└────────┘    │     │    └────────┘    │     │    └────────┘</div>
<div class="line">              └──┬──┘                  └─────┘</div>
<div class="line">                 │</div>
<div class="line">┌────────┐       │</div>
<div class="line">│ Device ├───────┘</div>
<div class="line">└────────┘</div>
</div><!-- fragment --> <div class="fragment"><div class="line">         Invalid network structure:</div>
<div class="line"> </div>
<div class="line">┌────────┐       ┌────────┐</div>
<div class="line">│ Device ├───╳───┤ Device │</div>
<div class="line">└────────┘       └────────┘</div>
<div class="line">             Δ</div>
<div class="line">             └─── Direct device-to-device</div>
<div class="line">                  connections are NOT allowed</div>
<div class="line"> </div>
<div class="line">┌─────┐       ┌─────┐</div>
<div class="line">│     │       │     │</div>
<div class="line">│ Bus ├───╳───┤ Bus │</div>
<div class="line">│     │       │     │</div>
<div class="line">└─────┘   Δ   └─────┘</div>
<div class="line">          │</div>
<div class="line">          └─── Direct bus-to-bus connections</div>
<div class="line">               are NOT allowed</div>
</div><!-- fragment --> There is no theoretical limit on the number of components in your network, although the more components there are on the network, the more CPU performance it will take to simulate. libelec is optimized to be able to efficiently simulate networks composed of thousands of devices and hundreds of buses.</li>
<li>libelec utilizes an idealized component model. For example, buses and shunts have no electrical resistance. Devices such as batteries and generators, however, do have non-perfect efficiency. You can control how efficient these devices are and libelec will account for efficiency losses.</li>
<li>Even though libelec supports simulating AC circuits, it assumes that all loads are perfectly resistive, meaning, there is no simulation of apparent power or less-than-1 power factor (cos-Phi).</li>
<li>No mixing of AC and DC devices on a single bus is allowed.</li>
<li>DC components can be powered by more than one source of electrical energy at the same time. In that case, the current is split between the sources based on the ratio of the product of their voltages and the inverse of their internal resistance. This means that even if two sources are of equal voltage, the current draw can skew much more towards one, if its internal resistance is lower than the other.</li>
<li>AC components must only ever have a single power source at any given time. This doesn't mean that a component could only ever be powered from a single AC source overall, only that at any single point in time, no more than one AC source may power a given component.</li>
</ol>
<h1><a class="anchor" id="autotoc_md15"></a>
General File Structure</h1>
<p>The file is generally structured into two large sections:</p>
<ol type="1">
<li>The list of devices</li>
<li>The list of buses and their connections to the devices</li>
</ol>
<p>As the electrical network can get quite complicated, you are encouraged to keep a visual record of the network's layout using some 3rd party diagram program.</p>
<h1><a class="anchor" id="autotoc_md16"></a>
Component Types</h1>
<p>Every component on the network has at least these two properties:</p>
<ol type="1">
<li>A component type. This is an enum of type elec_comp_type_t.</li>
<li>A unique name. This is used to identify the component in the network definition file and form connections. Names cannot contain spaces. You are encouraged to use simple names, such as "GEN_1" or "MAIN_BATT".</li>
</ol>
<p>In addition, components can have other properties, which are type-specific.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
Battery</h2>
<p>A battery is a component which can hold a certain amount of energy. This energy can then either be discharged (when a load is connected to the battery), or recharged (when a generator or energy source of a higher voltage than the battery's output voltage is attached). The rate of recharge is controlled by the battery's charging resistance, while the rate of discharge is largely driven by the demands of the downstream loads. To simulate the effects of internal battery resistance to discharge, a battery will depress its output voltage as it approaches its power flow limits.</p>
<p>Sample battery definition: </p><div class="fragment"><div class="line">BATT            MAIN_BATT</div>
<div class="line">    VOLTS       24.9</div>
<div class="line">    CAPACITY    1000000</div>
<div class="line">    MAX_PWR     10000</div>
<div class="line">    CHG_R       0.1</div>
<div class="line">    INT_R       1</div>
</div><!-- fragment --><ul>
<li><code>BATT</code>: starts a new battery definition block. The parameter of this config stanza is the name of the battery.</li>
<li><code>VOLTS</code> (mandatory): defines the battery's nominal voltage. This is the voltage the battery will achieve when fully charged, not loaded and at a temperature which isn't too cold (above roughly +15°C).</li>
<li><code>CAPACITY</code> (mandatory): the energy capacity of the battery in Joules. The energy content of the battery will change as it is discharged or recharged, but also with temperature. A very cold battery effectively holds less available total energy, due to a reduction of the rate of chemical reactions in the battery.</li>
<li><code>MAX_PWR</code> (mandatory): maximum rated power flow of the battery in Watts. When the amount of power being drawn from the battery gets close to, or exceeds this value, the battery will begin to significantly reduce its output voltage.</li>
<li><code>CHG_R</code> (mandatory): the charging resistance in Ohms. The higher this number, the more slowly the battery will charge. This must be a positive number, typically in the range of a few hundred milliohms. Setting this too low will result in excessively large current draw from the battery charger, while setting it too high will cause the battery to hardly charge at all.</li>
<li><code>INT_R</code> (mandatory): internal resistance of the battery in Ohms. This is used when calculating multi-source current distribution on a DC network. Current demand is distributed among current sources by the ratio of the voltage and the inverse of the internal resistance of each source.</li>
</ul>
<h2><a class="anchor" id="autotoc_md18"></a>
Generator</h2>
<p>A generator is a component which converts mechanical input energy into electrical output energy. You MUST supply a callback using <a class="el" href="libelec_8h.html#a1578efa53417a927d54861bee07e0dff">libelec_gen_set_rpm_cb()</a>, which informs libelec how fast the input shaft of the generator is turning. Please note that libelec doesn't impose any specific units for rotational speed. All you need to do is be consistent between the units being used throughout your network, since libelec uses them for lookups into the speed behavior tables.</p>
<p>Sample generator definition: </p><div class="fragment"><div class="line">GEN             GEN_1</div>
<div class="line">    VOLTS       115</div>
<div class="line">    FREQ        400</div>
<div class="line">    STAB_RATE   0.1</div>
<div class="line">    STAB_RATE_F 0.1</div>
<div class="line">    EXC_RPM     15</div>
<div class="line">    MIN_RPM     50</div>
<div class="line">    MAX_RPM     120</div>
<div class="line">    INT_R       0.001</div>
<div class="line">    CURVEPT     EFF     0       0.8</div>
<div class="line">    CURVEPT     EFF     5000    0.86</div>
<div class="line">    CURVEPT     EFF     10000   0.89</div>
<div class="line">    CURVEPT     EFF     15000   0.9</div>
<div class="line">    CURVEPT     EFF     20000   0.89</div>
<div class="line">    CURVEPT     EFF     25000   0.87</div>
<div class="line">    CURVEPT     EFF     30000   0.83</div>
<div class="line">    CURVEPT     EFF     60000   0.8</div>
</div><!-- fragment --><ul>
<li><code>GEN</code>: starts a new generator definition block. The parameter of this config stanza is the name of the generator.</li>
<li><p class="startli"><code>VOLTS</code> (mandatory) and <code>FREQ</code> (optional): defines the generators's nominal voltage and optionally, its nominal frequency (for AC generators). DC generators have a frequency of zero. You can create a DC generator by specifying <code>FREQ 0</code> or simply leaving out the <code>FREQ</code> stanza entirely.</p>
<p class="startli">Actual output voltage and frequency will depend upon the generator's current rpm, and the <code>EXC_RPM</code>, <code>MIN_RPM</code>, <code>MAX_RPM</code> and <code>STAB_RATE</code> (or <code>STAB_RATE_U</code> and <code>STAB_RATE_F</code>) parameters:</p><ul>
<li>If the generator's current speed is below the <code>EXC_RPM</code> speed, the output voltage and frequency will be zero (the generator is operating below the minimum field excitation speed).</li>
<li>If the generator is operating above <code>EXC_RPM</code> but below <code>MIN_RPM</code>, the generator's voltage and frequency will be scaled linearly from zero up to the nominal voltage/frequency near <code>MIN_RPM</code>.</li>
<li>If the generator is operating between <code>MIN_RPM</code> and <code>MAX_RPM</code>, its voltage and frequency will be stabilized based on the <code>STAB_RATE</code>, <code>STAB_RATE_U</code> and <code>STAB_RATE_F</code> parameters. Since most generators utilize a constant-speed drive unit, which doesn't adapt to changes of engine speed instantaneously, there can be momentary excursions of voltage and frequency outside of the nominal parameters when engine speed suddenly changes.</li>
<li>If the generator is operating above <code>MAX_RPM</code>, its voltage and frequency will exceed their nominal values in proportion to the exceedance.</li>
</ul>
</li>
<li><p class="startli"><code>STAB_RATE</code>, <code>STAB_RATE_U</code> and <code>STAB_RATE_F</code> (optional): these parameters specify how quickly the generator's stabilization system adapts to changes in generator input speed. The rate parameter works as an approximate time delay between the actual generator speed and the corrective speed which the stabilization system can compensate for. The <code>STAB_RATE</code> stanza changes the stabilization rate for both the voltage and frequency response together, while <code>STAB_RATE_U</code> defines only the voltage stabilization rate, and <code>STAB_RATE_F</code> defines only the frequency stabilization rate (allowing you specify different stabilization rates for voltage and frequency, if so desired). A stabilization rate of zero makes the generator compensate for speed changes instantaneously (which is the default if no <code>STAB_RATE</code> stanza is found).</p>
<p class="startli">For example:</p><ul>
<li>let actual generator speed be "X"</li>
<li>let stabilized generator speed be "Y"</li>
<li>let the stabilization error "E" = X - Y</li>
<li>let stabilization rate be "R"</li>
<li>if E == 0, then the generator's output voltage and frequency correspond almost perfectly to their nominal values (except for some electrical noise, which libelec injects)</li>
<li>if E != 0, then the stabilization system will take "R" seconds to <b>reduce</b> this error by ~2/3 of its current value towards zero. While E is non-zero, the voltage and frequency will differ from their nominal values in proportion of E / ((MAX_RPM - MIN_RPM) / 2)</li>
<li>as a concrete example, if actual generator speed is 2,000 rpm and the stabilization system is compensating for a speed of 1,900 rpm, with a stabilization rate of 0.1 seconds, then after 0.1 seconds, the stabilization system speed will move by ~2/3s towards 2,000 rpm (i.e. ~1,970 rpm). After another 0.1 seconds, it will again move by another ~2/3 of the error towards 2,000 rpm (i.e. 1,990 rpm), etc. During this time, if the generator's nominal speed is 2,000 rpm, then the generator's actual output voltage and frequency will be 100/2000 = 5% below nominal at the start, then ~1.5% low after 0.1 seconds, then ~0.5% low after 0.2 seconds, etc. These are extreme examples - during actual operation, the system recomputes the network state every 50ms and generator speeds do not change in such extreme steps.</li>
</ul>
</li>
<li><code>EXC_RPM</code> (optional): defines the minimum "excitation" speed at which the generator starts to provide non-zero output voltage and frequency.</li>
<li><code>MIN_RPM</code> (mandatory): defines the minimum speed at which the generator's stabilization system is able to fully compensate and provide the generator's nominal voltage and frequency. If the generator is operating above <code>EXC_RPM</code> but below <code>MIN_RPM</code>, the generator's voltage and frequency will be scaled linearly from zero up to the nominal voltage/frequency near <code>MIN_RPM</code>. The value for <code>MIN_RPM</code> MUST be less than the value for <code>MAX_RPM</code>.</li>
<li><code>MAX_RPM</code> (mandatory): defines the maximum speed at which the generator's stabilization system is able to fully compensate and provide the generator's nominal voltage and frequency. If the generator is operating above <code>MAX_RPM</code>, its voltage and frequency will exceed their nominal values in proportion to the exceedance.</li>
<li><code>INT_R</code> (optional): internal resistance of the generator in Ohms. This is used when calculating multi-source current distribution on a DC network. Current demand is distributed among current sources by the ratio of the voltage and the inverse of the internal resistance of each source.</li>
<li><p class="startli"><code>CURVEPT EFF</code> (mandatory, minimum of two lines): these lines define a piecewise linear function which approximates the generator's efficiency. The two numbers following the <code>EFF</code> word define the X coordinate (power in Watts) and Y coordinate (efficiency as a fraction of 0 - 1, exclusive). The lines must describe the function in increasing power draw. libelec will extrapolates points which lay outside of this function from the nearest specified linear segment. Efficiency values MUST fall with in the range 0.0 (inclusive) to 1.0 (exclusive).</p>
<p class="startli">Please note that due to the extrapolation nature, if you don't provide enough points and the power draw on the generator is extreme, the extrapolation might give a bad efficiency value, such as a negative number, or a number over 100%, which will cause a runtime assertion failure in libelec. You should terminate your functions with a flat linear segment to prevent this.</p>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md19"></a>
Transformer-Rectifier Unit (TRU)</h2>
<p>A Transformer-Rectifier Unit is a component which performs two tasks:</p>
<ol type="1">
<li>It transforms the voltage of the input to a different voltage on the output.</li>
<li>It rectifies AC to DC</li>
</ol>
<p>libelec's TRUs are simple devices, whose output voltage always scales in proportion to their input voltage. Thus, they do not provide a stabilized output voltage, but instead depend on the ability of the AC-side generator to supply a stable voltage. A TRU doesn't permit reverse current flow from its output side to the input.</p>
<div class="fragment"><div class="line">TRU             TRU_1</div>
<div class="line">    IN_VOLTS    115</div>
<div class="line">    OUT_VOLTS   28</div>
<div class="line">    INT_R       0.001</div>
<div class="line">    CURVEPT     EFF     0       0.7</div>
<div class="line">    CURVEPT     EFF     333     0.81</div>
<div class="line">    CURVEPT     EFF     666     0.85</div>
<div class="line">    CURVEPT     EFF     1333    0.90</div>
<div class="line">    CURVEPT     EFF     2000    0.93</div>
<div class="line">    CURVEPT     EFF     2666    0.94</div>
<div class="line">    CURVEPT     EFF     3333    0.92</div>
<div class="line">    CURVEPT     EFF     4000    0.85</div>
<div class="line">    CURVEPT     EFF     8000    0.75</div>
<div class="line">    CURVEPT     EFF     16000   0.74</div>
<div class="line">    CURVEPT     EFF     30000   0.74</div>
</div><!-- fragment --><ul>
<li><code>TRU</code>: starts a new TRU definition block. The parameter of this config stanza is the name of the TRU.</li>
<li><code>IN_VOLTS</code> (mandatory): defines the nominal operating voltage on the TRU's input (AC) side.</li>
<li><code>OUT_VOLTS</code> (mandatory): defines the nominal operating voltage on the TRU's output (DC) side.</li>
<li><code>INT_R</code> (optional): internal resistance of the TRU in Ohms. This is used when calculating multi-source current distribution on a DC network. Current demand is distributed among current sources by the ratio of the voltage and the inverse of the internal resistance of each source.</li>
<li><p class="startli"><code>CURVEPT EFF</code> (mandatory, minimum of two lines): these lines define a piecewise linear function which approximates the TRU's efficiency. The two numbers following the <code>EFF</code> word define the X coordinate (power in Watts) and Y coordinate (efficiency as a fraction of 0 - 1, exclusive). The lines must describe the function in increasing power draw. libelec will extrapolates points which lay outside of this function from the nearest specified linear segment. Efficiency values MUST fall with in the range 0.0 (inclusive) to 1.0 (exclusive).</p>
<p class="startli">Please note that due to the extrapolation nature, if you don't provide enough points and the power draw on the TRU is extreme, the extrapolation might give a bad efficiency value, such as a negative number, or a number over 100%, which will cause a runtime assertion failure in libelec. You should terminate your functions with a flat linear segment to prevent this.</p>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md20"></a>
Inverter</h2>
<p>An inverter is conceptually the opposite of a TRU. It changes DC power into AC power, and optionally also changes the input voltage to a different output voltage. Since a there are so many commonalities between TRUs and inverters, we will only cover the different configuration stanzas.</p>
<div class="fragment"><div class="line">INV             INV_1</div>
<div class="line">    IN_VOLTS    28</div>
<div class="line">    OUT_VOLTS   115</div>
<div class="line">    OUT_FREQ    400</div>
<div class="line">    INT_R       0.001</div>
<div class="line">    CURVEPT     EFF     0       0.7</div>
<div class="line">    CURVEPT     EFF     333     0.81</div>
<div class="line">    CURVEPT     EFF     666     0.85</div>
<div class="line">    CURVEPT     EFF     1333    0.90</div>
<div class="line">    CURVEPT     EFF     2000    0.93</div>
<div class="line">    CURVEPT     EFF     2666    0.94</div>
<div class="line">    CURVEPT     EFF     3333    0.92</div>
<div class="line">    CURVEPT     EFF     4000    0.85</div>
<div class="line">    CURVEPT     EFF     8000    0.75</div>
<div class="line">    CURVEPT     EFF     16000   0.74</div>
<div class="line">    CURVEPT     EFF     30000   0.74</div>
</div><!-- fragment --><ul>
<li><code>INV</code>: starts a new inverter definition block. The parameter of this config stanza is the name of the inverter.</li>
<li><code>OUT_FREQ</code> (mandatory): defines the nominal output frequency of the inverter.</li>
</ul>
<h2><a class="anchor" id="autotoc_md21"></a>
Load</h2>
<p>A load is a consumer of electrical energy. This can be anything you need it to be. libelec tells you if the load is powered (and how much energy it is consuming), and you then implement your custom systems behaviors based on that energy usage. Loads can either have internal power supplies, or be simple unregulated energy consumers. You can customize all of this behavior to suit your needs.</p>
<p>Loads come in several varieties of power demand, depending on your needs:</p>
<ol type="1">
<li>Constant-current loads: these loads generate a fixed amount of current demand from their input bus. If you specify a load callback using <a class="el" href="libelec_8h.html#a6e14c40eb12b728b5e7265a65380e69f">libelec_load_set_load_cb()</a>, you can control the amount of current draw, but it is assumed that your callback will return the amount of <b>current</b> demanded in Amps.</li>
<li>Constant-power loads: these loads contain an internal stabilized power supply (such as a switching power supply), which will vary the amount of input current to provide a constant amount of power to its attached load. If you specify a load callback using <a class="el" href="libelec_8h.html#a6e14c40eb12b728b5e7265a65380e69f">libelec_load_set_load_cb()</a>, you can control the amount of power draw, but it is assumed that your callback will return the amount of <b>current</b> demanded in Watts.</li>
</ol>
<p>In addition, you can define a parameter called "input capacitance." This models the behavior of many devices, which contain large smoothing capacitors in their power supplies. These power supplies can continue to power the device for a brief period of time (fractions of a second, all the way to several seconds), if input power is suddenly lost. libelec allows you to model these behaviors by specifying a virtual capacitor contained in the load's input, which will both produce a sudden inrush charging current when the load is initially connected, as well as a slow decay of power supply voltage over time, if input power is suddenly lost.</p>
<div class="fragment"><div class="line">  Conceptual model of load</div>
<div class="line">     input capacitance</div>
<div class="line"> </div>
<div class="line">+ o──────────o────────────┐</div>
<div class="line">             │            │</div>
<div class="line">             │        ┌───┴────┐</div>
<div class="line">  Incap    ━━┷━━      │ Actual │</div>
<div class="line">           ━━┯━━      │  Load  │</div>
<div class="line">             │        └───┬────┘</div>
<div class="line">             │            │</div>
<div class="line">- o──────────o────────────┘</div>
</div><!-- fragment --><p>Sample load definition: </p><div class="fragment"><div class="line">LOAD            FOO     AC</div>
<div class="line">    STAB        TRUE</div>
<div class="line">    MIN_VOLTS   80</div>
<div class="line">    LOADCB      5       MyPosition</div>
<div class="line">    STD_LOAD    25</div>
<div class="line">    INCAP       1e-3    50</div>
</div><!-- fragment --><ul>
<li><code>LOAD</code>: starts a new load definition block. The two parameter of this config stanza is the name of the load and either the word "AC" or "DC", designating the load as either being an AC or DC load. This is only used for error checking. It is illegal to try to attach an AC load to a DC bus and vice versa.</li>
<li><code>STAB</code> (optional): a boolean value specifying whether the load is stabilized (constant-power) or unstabilized (constant-current).</li>
<li><code>MIN_VOLTS</code> (optional for unstabilized, mandatory for stabilized): defines the minimum voltage, below which the load is considered "unpowered." If the power supply output voltage of the load drops below this level, the load stops drawing all power from the power supply. Any residual input capacitance is slowly discharged through leakage current.</li>
<li><p class="startli"><code>LOADCB</code> or <code>LOADCB3</code> (optional): these are shorthand lines meant for auto-generating load-attached circuit breakers and connecting buses. It is a common pattern in many aircraft that end devices (modeled in libelec as loads) are protected by their own individual breakers. By specifying this stanza, you can generate a circuit breaker and connecting bus between the breaker and the load automatically. The <code>LOADCB3</code> variant is the same as <code>LOADCB</code>, but it auto-generates a 3-phase breaker, instead of a 1-phase breaker. This line takes 1 mandatory and 1 optional argument:</p><ul>
<li>the first argument is a mandatory breaker rating in Amps, for the breaker to be auto-generated.</li>
<li>the second argument is optional and is a textual description of the location the breaker on a breaker panel (if any). This is used when drawing the network visualization, but otherwise doesn't affect the physics of the simulation.</li>
</ul>
<p class="startli">If you specify this stanza, the following components on the network are automatically generated: </p><div class="fragment"><div class="line">               CB_&lt;LoadName&gt;_BUS</div>
<div class="line">CB_&lt;LoadName&gt;       ┌─────┐          &lt;LoadName&gt;</div>
<div class="line">  ┌──────┐          │     │           ┌──────┐</div>
<div class="line">  │  CB  ├──────────┤ Bus ├───────────┤ Load │</div>
<div class="line">  └──────┘          │     │           └──────┘</div>
<div class="line">                    └─────┘</div>
</div><!-- fragment --><p class="startli">When using this config stanza, you should attach the upstream bus from the load to a component named <code>CB_&lt;LoadName&gt;</code>, instead of the load itself. libelec auto-generates the connections from the CB, to the CB-to-load bus and finally, the connection from the CB-to-load bus to your actual load.</p>
</li>
<li><code>STD_LOAD</code> (optional): allows you to specify a "standard load" which is the demand that the load is generating on its input. This allows you to easily specify a load which always draws a known amount of current or power from its input, thus avoiding having to write callbacks for every single load on the network. If you do decide to provide a load demand callback by calling <a class="el" href="libelec_8h.html#a6e14c40eb12b728b5e7265a65380e69f">libelec_load_set_load_cb()</a>, this stanza will be ignored.</li>
<li><code>INCAP</code> (optional): allows you specify the input capacitance behavior of the load's power supply. The two arguments of this stanza are the capacitance (in Farad) and the internal resistance for charging (in Ohms). If the input voltage into the power supply is higher than the capacitance voltage, the input capacitor will charge up, generating additional current demand on the input. The rate at which this capacitor charges depends on the voltage delta between the capacitor and the input, and the charging resistance. You should carefully set the resistance, to limit inrush current and prevent tripping breakers when you turn your electrical system on. Usually a value like 50-60 Ohms will produce a fairly modest inrush current (on a 28V system, this corresponds to an inrush current of of approximately half an Ampere). The length of time for this inrush current depends on the absolute capacitance. You should fine tune this to match the expected capacitance behavior of your load.</li>
</ul>
<h2><a class="anchor" id="autotoc_md22"></a>
Circuit Breaker</h2>
<p>Circuit breakers are devices which allow the passage of electrical current when closed. If open, current is not allowed to flow. A breaker can become open by either by manual pilot action, or automatically if the current flowing through the breaker exceeds the breaker's maximum rating. As such, circuit breakers are safety devices which prevent excessive current draw to protect the electrical network from damage due to faults or short-circuits.</p>
<p>libelec assumes CBs as being specifically thermal circuit breakers, which are breakers where a small amount of energy is used to heat up an internal filament. This amount of energy loss is carefully callibrated such that when current flow through the breaker exceeds its rating, the filament deforms sufficiently to trigger an internal control circuit, which then opens the breaker. As such, thermal breakers have a certain amount of "inertia" before responding. If the current exceedance is very brief and/or not very high, the filament's thermal inertia might cause the breaker not to "trip." Conversely, when the breaker trips, the filament might remain very hot and must cool off - the operator must wait a few seconds before attempting to close the breaker again, to account for this cooling period.</p>
<div class="fragment"><div class="line">CB              FOO     10</div>
<div class="line">    LOCATION    My-Panel-1</div>
<div class="line">CB3             BAR     25</div>
<div class="line">    LOCATION    My-Panel-2</div>
<div class="line">    FUSE</div>
</div><!-- fragment --><ul>
<li><code>CB</code> or <code>CB3</code>: start a new circuit breaker definition block. The first argument specifies the name of the breaker. The second argument specifies the current rating of the breaker in Amps. The <code>CB3</code> variant of the stanza specifies a 3-phase circuit breaker. This means that conceptually there are three linked circuit breakers in this one component and the actual current rating is 3x that listed in the second argument.</li>
<li><code>LOCATION</code> (optional): textual description of the location of the circuit breaker on a breaker panel. This is only used for in the network visualization rendering and not for any physics calculations.</li>
<li><code>FUSE</code> (optional): modifiers the visual depiction on the network visualization rendering to use the symbol for a fuse. You can still reset the fuse through a call to <a class="el" href="libelec_8h.html#af0950ae9c4b63eb37cc54334c1cdc91a">libelec_cb_set()</a>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md23"></a>
Shunt</h2>
<p>Shunts are current measuring devices inserted in-line with a circuit. In reality, shunts are very small, carefully callibrated resistors, which cause a small amount of voltage drop across their leads. This amount of voltage drop is then measured using a voltmeter and converted into a current measurement mathematically.</p>
<p>Since a properly sized shunt is meant to only cause a very small voltage drop in the circuit, libelec shunts are idealized devices which cause no voltage drop at all. You can also use these idealized shunts to represent other current measuring devices, such as AC current clamps (which cause no voltage drop in the circuit).</p>
<div class="fragment"><div class="line">SHUNT   FOO</div>
</div><!-- fragment --><ul>
<li><code>SHUNT</code>: start a new shunt definition block, as well as the name of the shunt.</li>
</ul>
<h2><a class="anchor" id="autotoc_md24"></a>
Tie</h2>
<p>Ties are devices which connect two or more buses together. You can think of ties as a generalization of contactors and relays. Each of the endpoints of a tie has two possible states: tied or not tied. When tied, the endpoint allows current to pass (in any direction) to all other endpoints which are currently tied. Conceptually, the tie behaves as a single electrical node, with links to the outside world which can be dynamically connected and disconnected:</p>
<div class="fragment"><div class="line">   4-pole tie fully open                B &amp; C tied, A &amp; D open</div>
<div class="line">   (no current can flow)           (current can flow between B &amp; C)</div>
<div class="line"> </div>
<div class="line">         A o   o C                           A o   o B</div>
<div class="line">                                                  ╱</div>
<div class="line">             O                                   O</div>
<div class="line">                                                ╱</div>
<div class="line">         B o   o D                           C o   o D</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">     A &amp; B tied, C &amp; D open              All endpoints tied</div>
<div class="line">(current can flow between A &amp; B)   (current can flow between all)</div>
<div class="line"> </div>
<div class="line">         A o   o B                           A o   o B</div>
<div class="line">            ╲ ╱                                 ╲ ╱</div>
<div class="line">             O                                   O</div>
<div class="line">                                                ╱ ╲</div>
<div class="line">         C o   o D                           C o   o D</div>
</div><!-- fragment --><p>The initial state of a tie is to not have any of its endpoints tied. You should use <a class="el" href="libelec_8h.html#aa6f876cd9322f705a2d7c76f43150ef3">libelec_tie_set_list()</a>, <a class="el" href="libelec_8h.html#a25508dddaebf2246ca8e95d1e1fd51cd">libelec_tie_set()</a>, <a class="el" href="libelec_8h.html#ad703bfd7400acbad0f36966056824cdc">libelec_tie_set_v()</a> or <a class="el" href="libelec_8h.html#aae3a4c58ca63bb6770816a2c4555cfdc">libelec_tie_set_all()</a> at runtime to configure the tie.</p>
<p>To form a simple electrical on/off switch, create a tie with just two endpoints. Then, when you want to close the switch, just set all endpoints of the tie into the "tied" state: </p><div class="fragment"><div class="line"> Open switch        Closed switch</div>
<div class="line"> </div>
<div class="line">    A   B               A   B</div>
<div class="line">────o   o────       ────o━━━o────</div>
</div><!-- fragment --><p>The specification syntax for a tie is:</p>
<div class="fragment"><div class="line">TIE     FOO</div>
</div><!-- fragment --><ul>
<li><code>TIE</code>: starts a new tie definition block and the name of the tie. Please note that the actual endpoints of the tie are specified later in a bus using the <code>ENDPT</code> stanza.</li>
</ul>
<h2><a class="anchor" id="autotoc_md25"></a>
Diode</h2>
<p>A diode is a component which prevents current flow opposite to the diode's forward sense. libelec's diode are DC-only devices and cannot be used on AC circuits. Use a component of type TRU to implement an AC-to-DC rectifier.</p>
<div class="fragment"><div class="line">DIODE   FOO</div>
</div><!-- fragment --><ul>
<li><code>DIODE</code>: starts a new diode definition block and the name of the diode. Please note that the actual endpoints of the tie are specified later in a bus using the <code>ENDPT</code> stanza with an <code>IN</code> or <code>OUT</code> keyword following the diode name. See "Bus" below.</li>
</ul>
<h2><a class="anchor" id="autotoc_md26"></a>
Bus</h2>
<p>Buses are the interconnecting "tissue" of the libelec network. Every component on the network must connect to one or more buses, and the buses themselves serve to distribute energy flows throughout the network. libelec buses are idealized power distribution mechanisms with no internal resistance.</p>
<div class="fragment"><div class="line">BUS             FOO     AC</div>
<div class="line">    ENDPT       DEV1</div>
<div class="line">    ENDPT       DEV2</div>
<div class="line">    ENDPT       DEV3</div>
<div class="line">    ENDPT       DIODE_1 IN</div>
<div class="line">    ENDPT       DIODE_2 OUT</div>
<div class="line">    ENDPT       TRU_1   AC</div>
<div class="line">    ...</div>
</div><!-- fragment --><ul>
<li><code>BUS</code>: starts a new bus definition block. The two parameter of this config stanza is the name of the bus and either the word "AC" or "DC", designating the bus as either being an AC or DC bus. This is only used for error checking. It is illegal to try to attach an AC load to a DC bus and vice versa.</li>
<li><p class="startli"><code>ENDPT</code>: specifies an endpoint of the bus. The argument of this stanza is the name of a suitable component to which the bus connects. You can repeat the <code>ENDPT</code> line as many times as necessary, to form all of the connections of the bus. Please note that buses may only connect to devices, not other buses. Also note that declaration order in the file is significant. Prior to specifying an <code>ENDPT</code> line, the device mentioned on the line must already have been declared. libelec doesn't perform forward lookup of device names in the file.</p>
<p class="startli">If the device is a diode, you must supply a second argument consisting of the word <code>IN</code> or <code>OUT</code>, depending on whether the connection is formed to the input or output end of the diode: </p><div class="fragment"><div class="line">         │ ╱│</div>
<div class="line">OUT o━━━━┥❬ ┝━━━━o IN</div>
<div class="line">         │ ╲│</div>
</div><!-- fragment --><p class="startli">If the device is a TRU or an inverter, you must also supply a second argument consisting of the word <code>AC</code> or <code>DC</code>, depending on whether the connection is formed to the AC or DC side of the device. </p>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
